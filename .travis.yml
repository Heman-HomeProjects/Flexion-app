language: java

jdk:
  - openjdk8

install: true

branches:
  only:
    - main

# MAVEN PROJECTS ONLY:
cache:
  directories:
    - $HOME/.m2
    - node
    - node_modules

env:
  global:
    - DEPLOY_BUCKET=flexion-master
    # - DEPLOY_BUCKET_PREFIX=exampleco # optional if using a shared deployment bucket
    - DEPLOY_BRANCHES=main # optional - all branches defined in "branches" above is the default
    # MAVEN PROJECTS:
    # - DEPLOY_SOURCE_DIR=$TRAVIS_BUILD_DIR/site/target # optional - if your war file is somewhere other than ./target
    - DEPLOY_SOURCE_DIR=~/.m2/app
    # GRADLE PROJECTS:
    #- DEPLOY_SOURCE_DIR=$TRAVIS_BUILD_DIR/site/build/libs # optional - if your war file is somewhere other than ./target
    #- GRADLE_PARAMS="optional additional paremters to pass along to gradle if using build-gradle.sh"

before_script:
  - git clone https://github.com/Heman-HomeProjects/Flexion-app.git
  - cp Flexion-app/flexionapp.py ~/.m2/app # optional
  - cp Flexion-app/deploy.sh ~/.m2/app
  - cp Flexion-app/build.rb ~/.m2/app
  - cp Flexion-app/flexionapp_image.png ~/.m2/app
  - ls -l ~/.m2/app

before_install:
  - chmod +x deploy.sh

script:
  # MAVEN PROJECTS:
  # - Flexion-app/build.rb --skip-tests-if-pr && Flexion-app/deploy.sh
  - $HOME/.m2/app/deploy.sh
  # GRADLE PROJECTS:
  #- travis-s3-deploy/build-gradle.sh && travis-s3-deploy/deploy.sh
